!function(t,e){var n=e.getElementById("layout"),o=e.getElementById("menu"),r=e.getElementById("menuLink"),i=e.getElementById("main");function a(t,e){for(var n=t.className.split(/\s+/),o=n.length,r=0;r<o;r++)if(n[r]===e){n.splice(r,1);break}o===n.length&&n.push(e),t.className=n.join(" ")}function s(t){var e="active";t.preventDefault(),a(n,e),a(o,e),a(r,e)}r.onclick=function(t){s(t)},i.onclick=function(t){-1!==o.className.indexOf("active")&&s(t)}}(0,this.document),function(t){"use strict";var e,h="undefined"==typeof window&&"undefined"!=typeof global&&"function"==typeof require,m=h?t.require:null,y={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},w={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};function g(){return h?e=e||"file://"+(process.platform.match(/^win/i)?"/":"")+m("fs").realpathSync("."):document.location.href}function i(t){return encodeURIComponent(t).replace(/'/g,"%27")}function v(t){return(t=(t=(t=t.replace(/\+/g," ")).replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,function(t,e,n,o){var r=parseInt(e,16)-224,i=parseInt(n,16)-128;if(0==r&&i<32)return t;var a=(r<<12)+(i<<6)+(parseInt(o,16)-128);return 65535<a?t:String.fromCharCode(a)})).replace(/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,function(t,e,n){var o=parseInt(e,16)-192;if(o<2)return t;var r=parseInt(n,16)-128;return String.fromCharCode((o<<6)+r)})).replace(/%([0-7][0-9a-f])/gi,function(t,e){return String.fromCharCode(parseInt(e,16))})}function S(t){for(var e,n=/([^=&]+)(=([^&]*))?/g;e=n.exec(t);){var o=decodeURIComponent(e[1].replace(/\+/g," ")),r=e[3]?v(e[3]):"";void 0!==this[o]&&null!==this[o]?(this[o]instanceof Array||(this[o]=[this[o]]),this[o].push(r)):this[o]=r}}function $(t,e){!function(t,e,n){var o,r,i;e=e||g(),h?o=m("url").parse(e):(o=document.createElement("a")).href=e;var a,s,u=(s={path:!0,query:!0,hash:!0},(a=e)&&/^[a-z]+:/.test(a)&&(s.protocol=!0,s.host=!0,/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i.test(a)&&(s.port=!0),/\/\/(.*?)(?::(.*?))?@/.test(a)&&(s.user=!0,s.pass=!0)),s);for(r in i=e.match(/\/\/(.*?)(?::(.*?))?@/)||[],y)u[r]?t[r]=o[y[r]]||"":t[r]="";if(t.protocol=t.protocol.replace(/:$/,""),t.query=t.query.replace(/^\?/,""),t.hash=v(t.hash.replace(/^#/,"")),t.user=v(i[1]||""),t.pass=v(i[2]||""),t.port=w[t.protocol]==t.port||0==t.port?"":t.port,!u.protocol&&/[^/#?]/.test(e.charAt(0))&&(t.path=e.split("?")[0].split("#")[0]),!u.protocol&&n){var d=new $(g().match(/(.*\/)/)[0]),c=d.path.split("/"),p=t.path.split("/"),l=["protocol","user","pass","host","port"],f=l.length;for(c.pop(),r=0;r<f;r++)t[l[r]]=d[l[r]];for(;".."===p[0];)c.pop(),p.shift();t.path=("/"!==e.charAt(0)?c.join("/"):"")+"/"+p.join("/")}t.path=t.path.replace(/^\/{2,}/,"/"),t.paths(t.paths()),t.query=new S(t.query)}(this,t,!e)}S.prototype.toString=function(){var t,e,n="",o=i;for(t in this)if(!(this[t]instanceof Function||null===this[t]))if(this[t]instanceof Array){var r=this[t].length;if(r)for(e=0;e<r;e++)n+=n?"&":"",n+=o(t)+"="+o(this[t][e]);else n+=(n?"&":"")+o(t)+"="}else n+=n?"&":"",n+=o(t)+"="+o(this[t]);return n},$.prototype.clearQuery=function(){for(var t in this.query)this.query[t]instanceof Function||delete this.query[t];return this},$.prototype.queryLength=function(){var t,e=0;for(t in this)this[t]instanceof Function||e++;return e},$.prototype.isEmptyQuery=function(){return 0===this.queryLength()},$.prototype.paths=function(t){var e,n="",o=0;if(t&&t.length&&t+""!==t){for(this.isAbsolute()&&(n="/"),e=t.length;o<e;o++)t[o]=!o&&t[o].match(/^\w:$/)?t[o]:i(t[o]);this.path=n+t.join("/")}for(o=0,e=(t=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/")).length;o<e;o++)t[o]=v(t[o]);return t},$.prototype.encode=i,$.prototype.decode=v,$.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)},$.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&i(this.user)+(this.pass&&":"+i(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+i(this.hash))},t[t.exports?"exports":"Url"]=$}("undefined"!=typeof module&&module.exports?module:window),function(){"use strict";window.Serious=window.Serious||{}}(),function(){"use strict";function e(t,e){e&&"function"==typeof e&&$(document).on(t,function(t){return e(t)})}window.Serious.on={startup:function(t){e("ready",t)},data:{start:function(t){e(":data-load-start",t)},loaded:function(t){e(":data-load-end",t)}},episode:{start:function(t){e(":episode-load-start",t)},loaded:function(t){e(":episode-load-end",t)}},render:{start:function(t){e(":render-start",t)},finish:function(t){e(":render-end",t)}}},Serious.on.episode.loaded(function(){$(document).ready(function(){$("#overlay").addClass("hide")})}),Serious.on.data.loaded(function(){$(document).ready(function(){$("#overlay").addClass("hide")})})}(),function(){"use strict";var r="on"===$(document.body).attr("data-debug");function i(t,e){$(document).trigger(Object.assign({type:t},e))}function a(t){return t=Number(t),Number.isNaN(t)&&(t=-1),t}function s(t){var e=new Url;e.clearQuery(),e.query.ep=t,window.location.href=e.toString()}window.Serious.render=function(e,o,t){var n;if(t||(Serious.data?t=Serious.data:console.error("Could not find story data.")),!(n=o?t.meta.find(function(t){return t.id===e}):t.story.find(function(t){return t.episode===e})))return i(":render-start",{title:"404",content:null}),$("#title").empty().append("404"),$("#subtitle").empty().append("Not found.").show(),void i(":render-end",{title:"404",content:null});i(":episode-load-start",n),$.getJSON((o?"./content/meta/":"./content/episodes/")+n.file,function(t){r&&console.log("loaded from file",t),i(":episode-load-end",n),function(n){i(":render-start",n),$(function(){$("#title").empty().append((o?"":n.data.episode+": ")+n.data.title),n.data.subtitle?$("#subtitle").empty().append(n.data.subtitle).show():$("#subtitle").hide(),marked(n.content,{smartypants:!0},function(t,e){$("#content").empty().append(e),i(":render-end",n)})})}(t)}),$("#content").attr("data-view","episode"),$(document.body).attr("data-ep",o?"meta":String(e)),o||($("a.nav").hide(),function(n,t){return n=a(n),t.story.some(function(t){var e=a(t.episode);return n+1===e})}(e,t)&&$("#next").show().on("click",function(t){s(Number(e)+1)}),function(n,t){return n=a(n),t.story.some(function(t){var e=a(t.episode);return n-1===e})}(e,t)&&$("#prev").show().on("click",function(t){s(Number(e)-1)}))},window.Serious.epLink=s,window.Serious.metaLink=function(t){var e=new Url;e.clearQuery(),e.query.meta=t,window.location.href=e.toString()},window.Serious.emit=i,window.Serious.debug=r}(),function(){"use strict";var p=Serious.debug||!1,l=Serious.emit||function(){};function f(t,e){var n=$(document.createElement(t)).addClass(e.classes).append(e.content||"");return delete e.classes,n.attr(e)}var e=f("div",{id:"deck",content:"<h1>Recent Episodes</h1>"});function n(t,e){var n,o;t||(Serious.data?t=Serious.data:console.error("Could not find story data.")),console.log(t),t.story.sort(function(t,e){return Number(t.episode)-Number(e.episode)}),o=e?(n=t.story.reverse()).length>=t.recentMax?t.recentMax:n.length:(n=t.story).length;for(var r=[],i=0;i<o;i++){var a=n[i],s=a.episode,u=f("div",{role:"button",title:"Read more...",classes:"episode-card",name:a.title,"data-goto":s}),d=f("h1",{classes:"episode-title",content:s+": "+a.title}),c=f("h2",{classes:"episode-desc",content:a.description});if(u.append(d,c).on("click",function(t){t.preventDefault(),Serious.epLink(Number($(this).attr("data-goto")))}),i<(e?t.recentsExcerpts:t.episodesExcerpts)){try{throw u}catch(e){l(":episode-load-start",a),$.getJSON("./content/episodes/"+a.file,function(t){p&&console.log("loaded from file",t),l(":episode-load-end",a),function(n,o){l(":render-start",n),$(function(){n.data.subtitle&&o.children("h1").after(f("h2",{classes:"episode-subtitle",content:n.data.subtitle})),marked(n.content,{smartypants:!0},function(t,e){o.append(f("p",{classes:"episode-preview",content:e})),l(":render-end",n)})})}(t,e)}),r.push(e)}}else u.append(f("p",{classes:"episode-preview empty",content:"&hellip;"}));r.push(u)}return r}window.Serious=window.Serious||{},window.Serious.recents=function(t){return e.append(n(t,!0))},window.Serious.list=function(t){return e.empty().append("<h1>Episode List</h1>",n(t))}}(),function(){"use strict";Serious.emit(":data-load-start"),$.getJSON("./content/index.json",function(t){Serious.debug&&console.log("loaded from file",t),function(o){window.Serious.data=o,Serious.emit(":data-load-end",o);var r=o.displayTitle?o.displayTitle:o.title?o.title:"Untitled",i=o.subtitle||"";document.title=r,$(function(){var t,e,n=new Url;if(n.query&&n.query.ep?window.Serious.render(Number(n.query.ep),!1,o):n.query&&n.query.meta?window.Serious.render(n.query.meta.trim().toLowerCase(),!0,o):($("#title").empty().append(r),i?$("#subtitle").empty().append(r).show():$("#subtitle").hide(),n.query&&n.query.list?$("#content").attr("data-view","ream").append(Serious.list(o)):$("#content").attr("data-view","ream").append(Serious.recents(o))),o.copyright&&"string"==typeof o.copyright&&o.copyright.trim()&&$("#user-copyright").empty().append(o.copyright,"<br />"),1<o.story.length&&$("#last-link").parent("li.pure-menu-item").removeClass("hide"),o.meta&&Array.isArray(o.meta)&&o.meta.length&&o.meta.forEach(function(e,t){var n=e.link.trim();"_"!==n&&$("#menu .pure-menu-list").append($(document.createElement("li")).addClass("pure-menu-item"+(0===t?" menu-item-divided":"")).append($(document.createElement("a")).addClass("pure-menu-link").attr({href:"#",title:e.label||""}).append(n).on("click",function(t){t.preventDefault(),Serious.metaLink(e.id)})))}),o.links&&Array.isArray(o.links)&&0<o.links.length&&o.links.forEach(function(t,e){t.url&&"string"==typeof t.url&&t.text&&"string"==typeof t.text&&$("#menu .pure-menu-list").append($(document.createElement("li")).addClass("pure-menu-item"+(0===e?" menu-item-divided":"")).append($(document.createElement("a")).addClass("pure-menu-link").attr({href:t.url,target:"_blank",title:t.label||""}).append(t.text)))}),o.disqusShortname&&"string"==typeof o.disqusShortname&&o.disqusShortname.trim()&&"meta"!==$(document.body).attr("data-ep")&&"0"!==$(document.body).attr("data-ep")){$("#title").text().trim().toLowerCase().replace(/[^A-Za-z0-9]*/,"-");t=document,(e=t.createElement("script")).src="https://"+o.disqusShortname.trim()+".disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e),$("#disqus_thread").removeClass("hide")}})}(t)})}(),function(){"use strict";$(function(){$("#first-link").on("click",function(){return Serious.epLink(1)}),$("#last-link").on("click",function(){return window.Serious&&window.Serious.data||$(document).on(":data-load-end",function(t){return Serious.epLink(t.data.story.length)}),Serious.epLink(Serious.data.story.length)})})}(),function(){var o=$(document.createElement("div")).attr("id","nsfw-warning"),r=$(document.createElement("a")).attr("id","nsfw-confirm").append("Continue"),i=$(document.createElement("div")).attr("id","overlay").append(o,r);$(document).on(":data-load-end",function(n){window.localStorage&&"ok"===localStorage.getItem("nsfw")||$(function(){var t,e=n.nsfw;e&&"boolean"!=typeof e?t="<p>This website contains sexually explicit content.</p><p>By continuing, you affirm that you are over the age of "+e+" and willing to see such content.</p>":nswf&&(t="<p>This website contains sexually explicit content.</p><p>By continuing, you affirm that you are over the age of 18 and willing to see such content.</p>"),t&&(o.append(t),$(document.body).append(i),r.on("click",function(){window.localStorage&&localStorage.setItem("nsfw","ok"),i.fadeOut(250,function(){i.remove()})}))})})}();